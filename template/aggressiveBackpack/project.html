{% extends 'aggressiveBackpack/base.html' %}

{% block title %}Project - AB{% endblock %}

{% block extra_scripts %}
<script src="../../static/js/custom/project-page.js"></script>
<script src="../../static/js/jquery.masonry.pkgd.min.js"></script>
{% endblock %}

{% block body_block %}
  <!-- Page header -->
  <div>
    <div class='col-lg-8'>
      <h1 id='type'><b>{{ project.name }}</b></h1>
      <h4>{{ project.description}}</h4>
      <p><i>Created by {{ project.owner }}</i></p>
    </div>
    <div class='col-lg-4'>
      <!-- List creation button -->
      <button id='new-list-button' data-toggle="modal" data-target="#new-list-modal" class="btn btn-primary btn-lg">New List</button>
      <button id='new-list-button' data-toggle="modal" data-target="#new-task-modal" class="btn btn-primary btn-lg">New Task</button>
    </div>

  </div>

  <!-- View Task dialog -->
  <div id='view-task-dialog' class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h4 class="modal-title">Task title here</h4>
        </div>
        <div class="modal-body">
          Details will be shown here once I figure out how to make them all display
        </div>
      </div>
    </div>
  </div>

  <!-- New list dialog -->
  <div id='new-list-modal' class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title">New List</h4>
      </div>
      <div class="modal-body">
        <!-- New List Form -->
        <form class="form-horizontal" id="new_list_form" method="post" action="/aggressiveBackpack/project/{{ projectURL }}/" enctype="multipart/form-data">
          {% csrf_token %}
          <fieldset>
              <!-- Project Name -->
              <div class="form-group">
                <input class="form-control input-lg" type="hidden" name='project' id="inputDefault" value='{{ project.id }}'>
              </div>

              <!-- Tasks -->
              <div class="form-group">
                <input type="hidden" class="form-control" name='tasks' id="inputDefault">
              </div>

              <!-- List name -->
              <div class="form-group">
                <textarea class="form-control" name='name' id="inputDefault" placeholder='List Name'></textarea>
              </div>

              <!-- Colour -->
              <div class="form-group">
                <p>Give your list a colour</p>
                <input type="color" name='colour' value="#fffff" placeholder='Colours!'>
              </div>
        </div>
      <div class="modal-footer">
        <!-- Submit & Cancel button -->
        <div class="form-group">
          <button type="submit" class="btn btn-primary">Create</button>
        </div>
      </div>
    </fieldset>
    </form>
    </div>
  </div>
</div>

<!-- New task Modal -->
<div class="modal fade" id="new-task-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Create a new task</h4>
      </div>
      <div class="modal-body">
        <!-- New Task Form -->
        <form class="form-horizontal" id="new_task_form" method="post" action="/aggressiveBackpack/project/{{ projectURL }}" enctype="multipart/form-data">
          {% csrf_token %}
          <fieldset>
              <!-- Parent project Name -->
              <div class="form-group">
                <input class="form-control input-lg" type="hidden" name='project' id="inputDefault" value="{{ project.id }}">
              </div>

              <!-- Dropdown for choosing which list to make new task in. -->
              <div class="form-group">
                <label for="select" class="col-lg-2 control-label">Parent List:</label>
                <select class="form-control" name='list' id="select">
                  {% for list in lists %}
                    <option>{{ list.name }}</option>
                  {% endfor %}
                </select>
              </div>

              <!-- Title -->
              <div class="form-group">
                <textarea class="form-control" name='title' id="inputDefault" placeholder='Title'></textarea>
              </div>

              <!-- Description -->
              <div class="form-group">
                <input type="text" class="form-control" name='description' id="textArea" placeholder='Description'>
              </div>

              <!-- Tags -->
              <div class="form-group">
                <input type="text" class="form-control" name='tags' id="inputDefault" placeholder='Tags, separated by commas'>
              </div>


        </div>
      <div class="modal-footer">
        <!-- Submit & Cancel button -->
        <div class="form-group">
          <button type="submit" class="btn btn-primary">Create</button>
        </div>
      </div>
    </fieldset>
    </form>
    </div>
  </div>
</div>

<!--Main list view
    Populates from Django's context with lists and tasks.
    Not decided if it will be a scrollable element (horizontally) or paginated.
    -->
<div class='col-lg-12'>
<div class='js-masonry' id'container' data-masonry-options='{ "columnWidth": 200, "itemSelector": ".item"}'>
  {% if lists %}
    {% for list in lists %}
      <div class='item'>
        {{ list.name }}<br>
        {% if list.tasks %}
          {% for task in tasks %}
            {% if task.list = list %}
              {{ task.title }}<br>
            {% endif %}
          {% endfor %}
        {% endif %}
      </div>
    {% endfor %}
  {% endif %}
</div>
</div>


<script src="../../static/js/jquery.masonry.pkgd.min.js"></script>
<script>
  $(function() (
    var=$container = $('#container');

    $container.masonry({
      itemSelector : '.item'
    });
  ));
</script>
{% endblock %}
